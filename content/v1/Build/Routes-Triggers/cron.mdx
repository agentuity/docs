---
title: Scheduling Cron Jobs
description: Run tasks on a schedule with router.cron()
---

Schedule recurring tasks using cron expressions. Schedules are defined in code, deployed with your agents, and automatically provisioned.

## Basic Example

```typescript
import { createRouter } from '@agentuity/runtime';

const router = createRouter();

router.cron('0 9 * * *', async (c) => { // runs daily at 9am
  c.var.logger.info('Daily report starting');

  const report = await c.agent.reportGenerator.run({
    type: 'daily',
    date: new Date().toISOString(),
  });

  await c.kv.set('reports', `daily-${Date.now()}`, report);

  return c.text('OK');
});

export default router;
```

## Cron Syntax

Standard five-field cron format:

```
┌───────────── minute (0-59)
│ ┌───────────── hour (0-23)
│ │ ┌───────────── day of month (1-31)
│ │ │ ┌───────────── month (1-12)
│ │ │ │ ┌───────────── day of week (0-6, Sunday=0)
│ │ │ │ │
* * * * *
```

## Common Schedules

| Schedule | Expression | Useful for |
|----------|------------|-------------|
| Every 5 minutes | `*/5 * * * *` | Health checks, quick sync |
| Hourly | `0 * * * *` | Aggregations, cleanup, etc. |
| Daily at 9am | `0 9 * * *` | Reports, notifications, etc. |
| Weekly (Sunday midnight) | `0 0 * * 0` | Weekly summaries, etc. |
| Monthly (1st at midnight) | `0 0 1 * *` | Monthly reports, etc. |

## Full Example

A health check that monitors external services and stores results:

```typescript
import { createRouter } from '@agentuity/runtime';

const router = createRouter();

router.cron('*/5 * * * *', async (c) => { // runs every 5 minutes
  const startTime = Date.now();
  c.var.logger.info('Health check starting');

  try {
    const status = await c.agent.healthChecker.run({
      services: ['api', 'database', 'cache'],
    });

    await c.kv.set('monitoring', 'latest-health', {
      ...status,
      checkedAt: new Date().toISOString(),
      durationMs: Date.now() - startTime,
    });

    c.var.logger.info('Health check completed', { status });
    return c.text('OK');
  } catch (error) {
    c.var.logger.error('Health check failed', { error });
    return c.text('ERROR', 500);
  }
});

export default router;
```

## Testing Locally

Cron jobs only trigger in deployed environments. For local testing, add a manual POST route:

```typescript
router.cron('0 9 * * *', cronHandler);

// Manual trigger for local development
router.post('/trigger', async (c) => {
  return cronHandler(c);
});

async function cronHandler(c) {
  const result = await c.agent.dailyReport.run({ date: new Date() });
  return c.json(result);
}
```

## Best Practices

- **Log job start and completion** for debugging scheduled tasks
- **Use `c.kv` or `c.objectstore`** to persist results for later inspection
- **Handle errors gracefully** so one failure doesn't break the schedule
- **Keep jobs idempotent** when possible, in case of retries

## Next Steps

- [HTTP Routes](/Build/Routes-Triggers/http-routes): Standard request/response endpoints
- [Email Handling](/Build/Routes-Triggers/email): Process incoming emails
- [Key-Value Storage](/Build/Storage/key-value): Store job results
